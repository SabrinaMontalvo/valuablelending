<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Valuable Calculator‚Ñ¢ ‚Äî Old-School + Mortgage Tools</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link rel="manifest" href="manifest.webmanifest" />

<!-- Inline styles so it looks right even without a separate CSS file -->
<style>
:root{
  --ink:#01311F;           /* emerald/ink */
  --gold:#C6AA58;          /* gold */
  --paper:#F3F2ED;         /* warm paper */
  --beige:#FFFDE7;         /* soft highlight */
  --line:#E7E1D6;          /* borders */
  --muted:#59564F;
  --radius:16px;
  --shadow:0 1px 0 rgba(17,17,17,.04),0 8px 24px rgba(1,49,31,.08);
}
*{box-sizing:border-box}
html,body{margin:0;background:var(--paper);color:var(--ink);
  font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
.wrap{max-width:1180px;margin:0 auto;padding:28px 20px}
header{background:var(--ink);color:#fff;padding:18px 20px}
header h1{margin:6px 0 14px;font-size:clamp(24px,2.8vw,38px);font-weight:800}
header .badge{display:inline-block;background:#0a2f23;color:#fff;border:1px solid #1a4636;
  padding:6px 10px;border-radius:999px;font-weight:700;font-size:13px}
header img{height:40px;width:auto;vertical-align:middle;margin-right:10px}

.grid{display:grid;gap:14px}
.g4{grid-template-columns:1fr}
.g6{grid-column:span 6}
.g8{grid-template-columns:repeat(12,1fr)}
@media(min-width:900px){
  .g4{grid-template-columns:1fr 1fr 1fr 1fr}
  .g8{grid-template-columns:repeat(12,1fr)}
  .g6{grid-column:span 6}
}
.card{background:#fff;border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px}
h2{font-size:clamp(18px,2.2vw,26px);margin:0 0 12px;display:flex;align-items:center;gap:8px}

label{display:block;font-size:13px;color:var(--muted);margin:8px 0 6px}
input,select,button{font:inherit}
input,select{
  width:100%;background:#fff;border:1px solid var(--line);border-radius:12px;padding:10px 12px;
  outline:none;box-shadow:inset 0 1px 0 rgba(17,17,17,.02)
}
input:focus,select:focus{border-color:#cdbf8b;box-shadow:0 0 0 3px rgba(198,170,88,.18)}
.btn{border:1px solid var(--line);background:#fff;border-radius:999px;padding:10px 14px;cursor:pointer}
.btn.gold{background:var(--gold);color:#1b1b1b;border-color:#b29a4f;font-weight:800}
.btn:active{transform:translateY(1px)}

.kpis{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
.kpi{background:var(--paper);border:1px solid var(--line);border-radius:12px;padding:10px}
.kpi .label{font-size:12px;color:var(--muted)}
.kpi .value{font-weight:800}

.note{font-size:13px;color:var(--muted)}
.legend{display:flex;gap:18px;align-items:center;flex-wrap:wrap}
.legend .swatch{width:12px;height:12px;border-radius:3px;display:inline-block}

.calc-screen{background:#e9f0e8;border:1px solid var(--line);border-radius:12px;padding:12px;
  text-align:right;font-weight:800;font-size:22px}
.keys{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:10px}
.key{background:#fff;border:1px solid var(--line);border-radius:12px;padding:12px;font-weight:700;cursor:pointer}
.key:hover{background:#faf8f0}
.key[data-k="="]{background:var(--gold)}
.key[data-k="C"],.key[data-k="‚å´"]{grid-column:span 2}

.canvas-wrap{display:flex;gap:18px;align-items:center;flex-wrap:wrap}
canvas.chart{width:320px;height:320px;display:block}

.table-wrap{overflow:auto;border:1px solid var(--line);border-radius:12px}
table{width:100%;border-collapse:collapse}
thead th{background:#faf9f4;border-bottom:1px solid var(--line);padding:10px;text-align:left;font-size:14px}
tbody td{border-top:1px solid var(--line);padding:8px}
tbody tr:nth-child(odd){background:#fcfbf8}

footer{color:var(--ink);border-top:1px solid var(--line);background:#f6f5f1;padding:18px 20px;margin-top:28px}
footer a{color:var(--ink)}
.small{font-size:12px}
</style>
</head>
<body>
  <header>
    <span class="badge">NMLS #575897</span>
    <h1>Valuable Calculator‚Ñ¢ <span style="color:var(--gold)">Old-School</span> + Mortgage Tools</h1>
    <div class="small" style="opacity:.85">Replace your calculator. Learn equity & payoff fast. (P&I only; educational.)</div>
  </header>

  <main class="wrap">

    <!-- Collapsible Calculator -->
    <section class="g4">
      <div class="card" style="grid-column:1 / span 4; max-width:520px">
        <details open>
          <summary style="cursor:pointer;font-weight:700">üñ© Old-School Calculator</summary>
          <div style="margin-top:12px">
            <div id="screen" class="calc-screen">0</div>
            <div class="keys">
              <button class="key" data-k="7">7</button><button class="key" data-k="8">8</button><button class="key" data-k="9">9</button><button class="key" data-k="/">√∑</button>
              <button class="key" data-k="4">4</button><button class="key" data-k="5">5</button><button class="key" data-k="6">6</button><button class="key" data-k="*">√ó</button>
              <button class="key" data-k="1">1</button><button class="key" data-k="2">2</button><button class="key" data-k="3">3</button><button class="key" data-k="-">‚àí</button>
              <button class="key" data-k="0">0</button><button class="key" data-k=".">.</button><button class="key" data-k="=">=</button><button class="key" data-k="+">+</button>
              <button class="key" data-k="C">C</button><button class="key" data-k="‚å´">‚å´</button>
            </div>
            <p class="note">Tip: you can also type numbers and operators on your keyboard.</p>
          </div>
        </details>
      </div>
    </section>

    <!-- Equity / LTV -->
    <section class="g8" style="margin-top:16px">
      <div class="card" style="grid-column:1 / span 12">
        <h2>üè† Equity / LTV (with other balances & 80% benchmark)</h2>
        <div class="grid" style="grid-template-columns:repeat(12,1fr)">
          <div class="g6">
            <label>Estimated Home Value ($)</label>
            <input id="v_value" type="number" value="330000" step="1000">
          </div>
          <div class="g6">
            <label>Primary Mortgage Balance ($)</label>
            <input id="v_mort" type="number" value="120000" step="1000">
          </div>
          <div class="g6">
            <label>Other Liens (HELOC / Solar / 2nd) ($)</label>
            <input id="v_other" type="number" value="0" step="500">
          </div>
          <div class="g6">
            <label>Benchmark LTV (%)</label>
            <input id="v_bench" type="number" value="80" step="1">
          </div>
        </div>

        <div class="kpis" style="margin-top:12px">
          <div class="kpi"><div class="label">Total Debt (incl. other)</div><div class="value" id="v_debt">‚Äî</div></div>
          <div class="kpi"><div class="label">LTV</div><div class="value" id="v_ltv">‚Äî</div></div>
          <div class="kpi"><div class="label">Max @ Benchmark</div><div class="value" id="v_max">‚Äî</div></div>
          <div class="kpi"><div class="label">Available @ Benchmark</div><div class="value" id="v_avail">‚Äî</div></div>
        </div>

        <div class="canvas-wrap" style="margin-top:10px">
          <canvas id="v_donut" class="chart" width="320" height="320"></canvas>
          <div class="note" style="max-width:480px">
            <p><strong>How to read the donut:</strong></p>
            <ul>
              <li><b>Outer ring</b> = Equity (gold) vs Debt (emerald) for the home value.</li>
              <li><b>Inner ring</b> splits Debt into <b>Mortgage</b> vs <b>Other Liens</b>.</li>
            </ul>
            <div class="legend">
              <span><span class="swatch" style="background:var(--gold)"></span> Equity</span>
              <span><span class="swatch" style="background:var(--ink)"></span> Debt total</span>
              <span><span class="swatch" style="background:#0D2E24"></span> Mortgage (inner)</span>
              <span><span class="swatch" style="background:#55786c"></span> Other liens (inner)</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Amortization -->
    <section class="g8" style="margin-top:16px">
      <div class="card" style="grid-column:1 / span 12">
        <h2>üìÖ Amortization with Start Date + Extra Payments</h2>

        <div class="grid" style="grid-template-columns:repeat(12,1fr)">
          <div class="g6">
            <label>Original Loan Amount ($)</label>
            <input id="a_amount" type="number" value="300000" step="1000">
          </div>
          <div class="g6">
            <label>APR (%)</label>
            <input id="a_rate" type="number" value="6.5" step="0.01">
          </div>
          <div class="g6">
            <label>Term (years)</label>
            <input id="a_years" type="number" value="30" step="1">
          </div>
          <div class="g6">
            <label>Origination Date</label>
            <input id="a_start" type="date" value="2025-09-01">
          </div>
          <div class="g6">
            <label>Current Balance (optional)</label>
            <input id="a_current" type="number" placeholder="leave blank for new-loan">
          </div>

          <div class="g6">
            <label>Extra Principal ($/mo)</label>
            <input id="a_extra" type="number" value="100" step="50">
          </div>
          <div class="g6">
            <label>Bi-weekly plan</label>
            <select id="a_biweekly"><option value="0">No</option><option value="1">Yes (‚âà 13th payment/yr)</option></select>
          </div>
          <div class="g6">
            <label>One-time Lump ($)</label>
            <input id="a_lump" type="number" value="0" step="500">
          </div>
          <div class="g6">
            <label>Lump applied at month #</label>
            <input id="a_lump_month" type="number" value="12" step="1">
          </div>
        </div>

        <div class="kpis" style="margin-top:12px">
          <div class="kpi"><div class="label">Base P&I</div><div class="value" id="k_base_pi">‚Äî</div></div>
          <div class="kpi"><div class="label">Projected Payoff</div><div class="value" id="k_new_date">‚Äî</div></div>
          <div class="kpi"><div class="label">Interest Saved vs No Extras</div><div class="value" id="k_int_saved">‚Äî</div></div>
          <div class="kpi"><div class="label">Months Saved</div><div class="value" id="k_saved">‚Äî</div></div>
        </div>

        <div style="margin:10px 0;display:flex;gap:10px;justify-content:flex-end">
          <button id="a_calc" class="btn gold">Calculate</button>
        </div>

        <div class="table-wrap">
          <table id="a_table">
            <thead>
              <tr>
                <th>#</th><th>Date</th>
                <th style="text-align:right">Payment</th>
                <th style="text-align:right">Interest</th>
                <th style="text-align:right">Principal</th>
                <th style="text-align:right">Extra</th>
                <th style="text-align:right">Balance</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <p class="note" style="margin-top:10px">
          Educational only; principal & interest shown (escrows not included). Not a commitment to lend.
          Bi-weekly modeled as one extra monthly payment per year (26 half-payments).
        </p>
      </div>
    </section>

  </main>

  <footer>
    <div class="wrap" style="padding-top:0">
      <div>¬© Sabrina Montalvo ‚Äî Valuable Calculator‚Ñ¢</div>
      <div class="small">Compliance: NMLS #575897 ¬∑ <a href="terms.html">Terms</a> ¬∑ <a href="privacy.html">Privacy</a> ¬∑ <a href="accessibility.html">Accessibility</a></div>
    </div>
  </footer>

<script>
/* ========= Calculator (with keyboard) ========= */
(()=> {
  const screen = document.getElementById('screen'); if(!screen) return;
  let cur='0', op=null, mem=null;
  const render=()=>{screen.textContent=cur;}
  const press=(k)=>{
    if(/^[0-9]$/.test(k)) cur=(cur==='0')?k:cur+k;
    else if(k==='.' && !cur.includes('.')) cur+='.';
    else if(k==='C'){cur='0';op=null;mem=null;}
    else if(k==='‚å´') cur=(cur.length>1)?cur.slice(0,-1):'0';
    else if(['+','-','*','/'].includes(k)){mem=parseFloat(cur);op=k;cur='0';}
    else if(k==='=' && op && mem!=null){
      const a=mem,b=parseFloat(cur); let r=0;
      if(op==='+') r=a+b; if(op==='-') r=a-b; if(op==='*') r=a*b; if(op==='/') r=b===0?0:a/b;
      cur=String(r);op=null;mem=null;
    }
    render();
  };
  document.querySelectorAll('.key').forEach(b=>b.addEventListener('click',()=>press(b.dataset.k)));
  document.addEventListener('keydown',(e)=>{
    const map={Enter:'=',Backspace:'‚å´',Escape:'C','*':'*','/':'/','+':'+','-':'-','.' :'.'};
    if(/^[0-9]$/.test(e.key)) {press(e.key); return;}
    if(map[e.key]){press(map[e.key]); e.preventDefault();}
  });
  render();
})();

/* ========= Equity / LTV ========= */
function money(v){return (v||0).toLocaleString(undefined,{style:'currency',currency:'USD'});}

function vUpdate(){
  const val   = +document.getElementById('v_value').value||0;
  const mort  = +document.getElementById('v_mort').value||0;
  const other = +document.getElementById('v_other').value||0;
  const bench = Math.max(0,Math.min(100,+document.getElementById('v_bench').value||0));

  const debt = mort+other;
  const ltv  = val? (debt/val)*100 : 0;

  document.getElementById('v_debt').textContent = money(debt);
  document.getElementById('v_ltv').textContent  = (Math.round(ltv*10)/10)+'%';
  const maxAtBench = val*(bench/100);
  const avail      = Math.max(0, maxAtBench - debt);
  document.getElementById('v_max').textContent   = money(maxAtBench);
  document.getElementById('v_avail').textContent = money(avail);

  drawDonutDual('v_donut', val, mort, other); // dual-ring donut
}
window.addEventListener('load', vUpdate);
['v_value','v_mort','v_other','v_bench'].forEach(id=>{
  const el=document.getElementById(id); if(el){el.addEventListener('input', vUpdate);}
});

/* Dual-ring donut: outer = equity vs debt, inner = mortgage vs other (within debt) */
function drawDonutDual(id, value, mort, other){
  const c=document.getElementById(id); if(!c) return; const ctx=c.getContext('2d');
  const w=c.width, h=c.height, dpr=window.devicePixelRatio||1; ctx.setTransform(1,0,0,1,0,0);
  c.width=w; c.height=h; ctx.scale(1,1);
  ctx.clearRect(0,0,w,h);

  const equity = Math.max(0,value - (mort+other));
  const debt   = Math.max(0,mort+other);
  const total  = Math.max(value, debt); // avoid zero divide

  // geometry
  const cx=w/2, cy=h/2;
  const R=140, r=95;               // outer ring thickness
  const ring=(R+r)/2, lw=R-r;
  const r2=65, r3=40;              // inner ring thickness
  const inner=(r2+r3)/2, lw2=r2-r3;
  const start=-Math.PI/2;

  // colors
  const colEquity=getComputedStyle(document.documentElement).getPropertyValue('--gold').trim()||'#C6AA58';
  const colDebt=getComputedStyle(document.documentElement).getPropertyValue('--ink').trim()||'#01311F';
  const colMort='#0D2E24';
  const colOther='#55786c';

  // background guides
  ctx.lineCap='round';

  // outer: equity vs debt
  const eqFrac = Math.max(0, Math.min(1, equity/total));
  const debtFrac = 1 - eqFrac;

  ctx.lineWidth=lw;
  ctx.beginPath(); ctx.arc(cx,cy,ring,start,start+Math.PI*2); ctx.strokeStyle='#EEEAE0'; ctx.stroke();

  // equity arc
  ctx.beginPath();
  ctx.arc(cx,cy,ring,start, start+Math.PI*2*eqFrac);
  ctx.strokeStyle=colEquity; ctx.stroke();

  // debt arc (rest of circle)
  ctx.beginPath();
  ctx.arc(cx,cy,ring,start+Math.PI*2*eqFrac, start+Math.PI*2);
  ctx.strokeStyle=colDebt; ctx.stroke();

  // inner: mortgage vs other (relative to debt)
  ctx.lineWidth=lw2;
  ctx.beginPath(); ctx.arc(cx,cy,inner,start,start+Math.PI*2); ctx.strokeStyle='#EEEAE0'; ctx.stroke();

  let mortFrac = debt? mort/debt : 0;
  mortFrac = Math.max(0,Math.min(1,mortFrac));

  // mortgage arc
  ctx.beginPath();
  ctx.arc(cx,cy,inner,start, start+Math.PI*2*mortFrac);
  ctx.strokeStyle=colMort; ctx.stroke();

  // other arc
  ctx.beginPath();
  ctx.arc(cx,cy,inner,start+Math.PI*2*mortFrac, start+Math.PI*2);
  ctx.strokeStyle=colOther; ctx.stroke();

  // center text (LTV and balances)
  const ltv = total? (debt/total*100):0;
  ctx.textAlign='center';
  ctx.fillStyle='#111'; ctx.font='800 24px system-ui'; ctx.fillText(Math.round(ltv)+'%',cx,cy-2);
  ctx.fillStyle='#555'; ctx.font='600 12px system-ui'; ctx.fillText('LTV',cx,cy-24);
  ctx.fillStyle='#333'; ctx.font='700 12px system-ui';
  ctx.fillText('Balances',cx,cy+18);
  ctx.fillStyle='#111'; ctx.font='700 14px system-ui';
  ctx.fillText((mort+other).toLocaleString(undefined,{style:'currency',currency:'USD'}),cx,cy+36);
}

/* ========= Amortization ========= */
const fmtUSD=(n)=> (n||0).toLocaleString(undefined,{style:'currency',currency:'USD'});
const addMonths=(d,m)=>{const t=new Date(d.getTime());t.setMonth(t.getMonth()+m);return t;}
const ymd=(d)=> d.toISOString().slice(0,10);
function mp(P,r,n){ if(r===0) return P/n; const a=Math.pow(1+r,n); return P*r*a/(a-1); }

function build({principal,apr,months,start,extra=0,biweekly=false,lump=0,lumpAt=null}){
  const r=apr/100/12, base=mp(principal,r,months), bonus=biweekly? base/12 : 0;
  let bal=principal, k=0, totalInt=0, rows=[];
  while(bal>0 && k<months+600){
    const d=addMonths(start,k), int=bal*r; let pr=base-int; let ex=extra+bonus;
    if(lump>0 && lumpAt && (k+1)===Number(lumpAt)) ex+=lump;
    if(pr+ex>bal) pr=Math.max(0,bal-ex);
    const pay=pr+int+ex; bal=Math.max(0, bal-pr-ex); totalInt+=int;
    rows.push({n:k+1,date:ymd(d),payment:pay,interest:int,principal:pr,extra:ex,balance:bal});
    if(bal<=0) break; k++;
  }
  return {rows,months:k+1,totalInt,basePI:base};
}

function gather(){
  const P = +document.getElementById('a_amount').value||0;
  const R = +document.getElementById('a_rate').value||0;
  const Y = +document.getElementById('a_years').value||30;
  const S = new Date(document.getElementById('a_start').value||'2025-09-01');
  const cur= +document.getElementById('a_current').value||0;
  const extra= +document.getElementById('a_extra').value||0;
  const biw  = document.getElementById('a_biweekly').value==='1';
  const lump = +document.getElementById('a_lump').value||0;
  const lm   = +document.getElementById('a_lump_month').value||null;

  const totalMonths = Math.max(1,Math.round(Y*12));
  let rem = totalMonths;
  if(cur>0){
    const elapsed = Math.max(0, Math.round((new Date()-S)/(1000*60*60*24*30.437)));
    rem = Math.max(1,totalMonths-elapsed);
  }
  const principal = cur>0? cur : P;
  return {principal, apr:R, months:rem, start:new Date(), extra, biweekly:biw, lump, lumpAt:lm};
}

function runAmort(){
  const cfg=gather();
  const base=build({...cfg, extra:0, biweekly:false, lump:0, lumpAt:null});
  const now =build(cfg);

  document.getElementById('k_base_pi').textContent = fmtUSD(base.basePI);
  const newEnd=addMonths(new Date(), now.months-1);
  document.getElementById('k_new_date').textContent=newEnd.toLocaleDateString();
  document.getElementById('k_saved').textContent=Math.max(0,base.months-now.months);
  document.getElementById('k_int_saved').textContent=fmtUSD(Math.max(0, base.totalInt-now.totalInt));

  const tbody=document.querySelector('#a_table tbody'); tbody.innerHTML='';
  const show=now.rows.slice(0,360);
  const f2=(n)=>n.toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2});
  for(const r of show){
    const tr=document.createElement('tr');
    tr.innerHTML=`
      <td>${r.n}</td>
      <td>${r.date}</td>
      <td style="text-align:right">${f2(r.payment)}</td>
      <td style="text-align:right">${f2(r.interest)}</td>
      <td style="text-align:right">${f2(r.principal)}</td>
      <td style="text-align:right;color:var(--gold)">${f2(r.extra)}</td>
      <td style="text-align:right">${f2(r.balance)}</td>`;
    tbody.appendChild(tr);
  }
}
document.getElementById('a_calc')?.addEventListener('click',runAmort);
['a_amount','a_rate','a_years','a_start','a_current','a_extra','a_biweekly','a_lump','a_lump_month']
  .forEach(id=>{const el=document.getElementById(id); if(el){el.addEventListener('input',()=>setTimeout(runAmort,150)); el.addEventListener('change',()=>setTimeout(runAmort,150));}});
window.addEventListener('load',runAmort);
</script>
</body>
</html>
