<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Valuable Calculator‚Ñ¢ ‚Äî Old-School + Mortgage Tools</title>
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#01311F" />

<style>
  :root{
    --emerald:#01311F;
    --gold:#C6AA58;
    --cream:#F3F2ED;
    --paper:#F7F5F1;
    --mauve:#C8A1C6;
    --mint:#7FBF9E;
    --ink:#111;
    --line:#E3E0DA;
    --shadow:0 2px 10px rgba(0,0,0,.06);
    --radius:14px;
  }
  *{box-sizing:border-box}
  html,body{margin:0}
  body{
    background:#faf9f7;
    color:var(--ink);
    font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  }
  header{
    background:var(--emerald);
    color:#fff;
    padding:16px 20px 22px;
  }
  header .badge{
    display:inline-block;
    font-size:12px;
    padding:6px 10px;
    background:rgba(255,255,255,.1);
    border:1px solid rgba(255,255,255,.25);
    border-radius:999px;
    margin-bottom:10px;
  }
  header h1{
    margin:6px 0 2px;
    font-size:clamp(26px,3.2vw,42px);
    letter-spacing:.2px;
  }
  header h1 .accent{color:var(--gold); font-weight:800}
  header p{margin:8px 0 0; opacity:.9; font-size:14px}

  .wrap{
    max-width:1100px;
    margin:20px auto 60px;
    padding:0 16px;
  }

  /* Sections */
  .card{
    background:#fff;
    border:1px solid var(--line);
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    padding:18px;
  }
  .card + .card{margin-top:20px}
  .card h2{
    margin:0 0 14px;
    font-size:20px;
    color:#0b2d22;
    display:flex; align-items:center; gap:10px;
  }
  .subgrid{
    display:grid;
    grid-template-columns:repeat(2,minmax(0,1fr));
    gap:14px;
  }
  @media (max-width: 860px){
    .subgrid{grid-template-columns:1fr}
  }

  label{font-weight:600; font-size:14px; display:block; margin:8px 0 6px}
  input, select, button{
    font:inherit;
  }
  input[type="text"], input[type="number"], input[type="date"], select{
    width:100%;
    padding:12px 12px;
    border-radius:10px;
    border:1px solid var(--line);
    background:#fff;
  }
  input[type="number"]::-webkit-outer-spin-button,
  input[type="number"]::-webkit-inner-spin-button{ -webkit-appearance: none; margin:0 }
  input[type="number"]{ appearance:textfield }

  .btn{
    display:inline-flex; align-items:center; justify-content:center;
    padding:12px 16px; border-radius:10px; border:0; cursor:pointer;
    background:var(--gold); color:#1a1608; font-weight:700;
    box-shadow:var(--shadow);
  }
  .btn.secondary{
    background:#fff; color:#1b3a2f; border:1px solid var(--line);
  }
  .pill{
    display:inline-block; padding:6px 10px; border:1px solid var(--line);
    border-radius:999px; font-size:12px; background:#fff;
  }

  /* Calculator */
  .calc{
    display:grid; gap:10px;
    grid-template-columns: repeat(4, minmax(0,1fr));
  }
  .calc-display{
    grid-column: 1 / -1;
    background:#eef3ef;
    border:1px solid var(--line);
    border-radius:10px; padding:12px 12px;
    height:48px; display:flex; align-items:center;
    font-variant-numeric: tabular-nums;
  }
  .calc button{
    height:56px; border-radius:12px; border:1px solid var(--line);
    background:#fff; cursor:pointer; font-weight:700;
  }
  .calc .eq{ background:var(--gold) }

  /* KPI mini panels */
  .kpis{ display:grid; grid-template-columns:repeat(4,minmax(0,1fr)); gap:10px; margin-top:12px }
  .kpi{ background:#fff; border:1px solid var(--line); border-radius:10px; padding:10px 12px }
  .kpi small{display:block; color:#2a4; font-weight:700}

  /* Donut */
  .donut-box{
    display:grid; grid-template-columns:320px 1fr; gap:18px; align-items:start;
    margin-top:10px;
  }
  @media (max-width: 860px){
    .donut-box{ grid-template-columns:1fr }
    canvas{ max-width:100%; height:auto }
  }
  .legend{display:flex; gap:16px; flex-wrap:wrap; margin-top:8px}
  .legend span{display:inline-flex; align-items:center; gap:8px}
  .swatch{width:14px; height:14px; border-radius:3px; border:1px solid #cfc9c4}

  /* Table */
  table{ width:100%; border-collapse:collapse; border:1px solid var(--line); border-radius:10px; overflow:hidden }
  thead th{ background:#faf8f3; border-bottom:1px solid var(--line); padding:10px 8px; text-align:left; font-size:14px }
  tbody td{ border-top:1px solid #eee; padding:10px 8px; font-variant-numeric:tabular-nums }

  /* Footer */
  footer{
    margin-top:36px; background:#fff; border-top:1px solid var(--line);
  }
  .foot-wrap{max-width:1100px; margin:0 auto; padding:20px 16px; color:#333}
  .foot-grid{
    display:flex; flex-wrap:wrap; gap:16px; align-items:center; justify-content:space-between;
    font-size:14px;
  }
  .links{display:flex; gap:12px}
  .links a{color:#1a3a2f; text-decoration:none; border-bottom:1px dotted #9aa}
  .note{font-size:12px; opacity:.85}
</style>
</head>
<body>

<header>
  <div class="badge">NMLS #575897</div>
  <h1>Valuable Calculator‚Ñ¢ <span class="accent">Old-School</span> + Mortgage Tools</h1>
  <p>Free, nostalgic, and practical. Always consult a licensed professional.</p>
</header>

<div class="wrap">

  <!-- Old-school calculator -->
  <section class="card" id="calc-card">
    <h2>Old-School Calculator</h2>
    <div class="calc">
      <input id="calcDisplay" class="calc-display" aria-label="Calculator display" value="0" />
      <!-- row 1 -->
      <button data-k="7">7</button>
      <button data-k="8">8</button>
      <button data-k="9">9</button>
      <button data-k="+">+</button>
      <!-- row 2 -->
      <button data-k="4">4</button>
      <button data-k="5">5</button>
      <button data-k="6">6</button>
      <button data-k="*">√ó</button>
      <!-- row 3 -->
      <button data-k="1">1</button>
      <button data-k="2">2</button>
      <button data-k="3">3</button>
      <button data-k="-">‚àí</button>
      <!-- row 4 -->
      <button data-k="0">0</button>
      <button data-k=".">.</button>
      <button class="eq" data-k="=">=</button>
      <button id="calcBack">‚å´</button>
    </div>
    <p style="margin:10px 0 0; font-size:13px; color:#333">
      Tip: click the display to type numbers & operators from your keyboard.
    </p>
  </section>

  <!-- Equity + donut -->
  <section class="card" id="equity-card">
    <h2>üè° Equity (Mortgage + Liens + Available)</h2>

    <div class="subgrid">
      <div>
        <label for="eqValue">Estimated Home Value ($)</label>
        <input id="eqValue" type="number" inputmode="decimal" value="330000" />
      </div>
      <div>
        <label for="eqMort">Primary Mortgage Balance ($)</label>
        <input id="eqMort" type="number" inputmode="decimal" value="120000" />
      </div>
      <div>
        <label for="eqOther">Other Liens (HELOC, Solar, 2nd) ($)</label>
        <input id="eqOther" type="number" inputmode="decimal" value="0" />
      </div>
      <div>
        <label for="eqBench">Benchmark LTV (%)</label>
        <input id="eqBench" type="number" min="60" max="100" step="1" value="80" />
      </div>
    </div>

    <div style="margin-top:10px">
      <button id="eqCalc" class="btn">Recalculate</button>
    </div>

    <div class="kpis">
      <div class="kpi"><div>Total Debt</div><small id="kpiDebt">$0</small></div>
      <div class="kpi"><div>LTV</div><small id="kpiLTV">0%</small></div>
      <div class="kpi"><div>Max @ Benchmark</div><small id="kpiMax">$0</small></div>
      <div class="kpi"><div>Available @ Benchmark</div><small id="kpiAvail">$0</small></div>
    </div>

    <div class="donut-box">
      <canvas id="donut" width="320" height="320" aria-label="Equity donut graph"></canvas>
      <div>
        <div class="legend">
          <span><span class="swatch" style="background:var(--mauve)"></span> Mortgage</span>
          <span><span class="swatch" style="background:var(--mint)"></span> Other liens</span>
          <span><span class="swatch" style="background:var(--gold)"></span> Available estimated equity</span>
          <span><span class="swatch" style="background:#f5f2ea"></span> Untouchable equity</span>
        </div>
        <p style="margin-top:10px; color:#2a3a35">
          The ring is your home‚Äôs value (outer = 100%). From the top ‚Äústart‚Äù mark clockwise:
          Mortgage (mauve) + Other Liens (mint) that are eating up equity already,
          <strong>gold shades available estimated equity</strong>, and cream shows
          <strong>untouchable equity</strong> (based on assumed LTV rules). As always,
          speak to a licensed professional and have them explain your solution.
        </p>
      </div>
    </div>
  </section>

  <!-- Amortization -->
  <section class="card" id="amort-card">
    <h2>üìÖ Amortization with Start Date + Extra Payments</h2>

    <div class="subgrid">
      <div>
        <label for="a_amount">Original Loan Amount ($)</label>
        <input id="a_amount" type="number" value="300000" />
      </div>
      <div>
        <label for="a_apr">APR (%)</label>
        <input id="a_apr" type="number" step="0.01" value="6.5" />
      </div>
      <div>
        <label for="a_term">Term (years)</label>
        <input id="a_term" type="number" value="30" />
      </div>
      <div>
        <label for="a_start">Origination Date</label>
        <input id="a_start" type="date" />
      </div>
      <div>
        <label for="a_curr">Current Balance (optional)</label>
        <input id="a_curr" type="number" placeholder="leave blank if new loan" />
      </div>
      <div>
        <label for="a_extra">Extra Principal ($/mo)</label>
        <input id="a_extra" type="number" value="100" />
      </div>
      <div>
        <label for="a_biweekly">Bi-weekly plan</label>
        <select id="a_biweekly">
          <option>No</option>
          <option>Yes</option>
        </select>
      </div>
      <div>
        <label for="a_lump">One-time Lump ($)</label>
        <input id="a_lump" type="number" value="0" />
      </div>
      <div>
        <label for="a_lumpm">Lump at month #</label>
        <input id="a_lumpm" type="number" value="12" />
      </div>
      <div style="display:flex; align-items:end">
        <button id="a_go" class="btn">Calculate</button>
      </div>
    </div>

    <div class="kpis" style="margin-top:16px">
      <div class="kpi"><div>Base P&I</div><small id="a_base">‚Äî</small></div>
      <div class="kpi"><div>Projected Payoff</div><small id="a_payoff">‚Äî</small></div>
      <div class="kpi"><div>Interest Saved</div><small id="a_saved">‚Äî</small></div>
      <div class="kpi"><div>Months Saved</div><small id="a_msaved">‚Äî</small></div>
    </div>

    <div style="overflow:auto; margin-top:12px">
      <table id="a_tbl">
        <thead><tr>
          <th>#</th><th>Date</th><th>Payment</th><th>Interest</th>
          <th>Principal</th><th>Extra</th><th>Balance</th>
        </tr></thead>
        <tbody></tbody>
      </table>
    </div>

    <p style="margin-top:12px; font-size:13px; color:#333">
      Educational only. Principal & interest shown (escrows not included). Not a commitment to lend.
      <strong>Bi-weekly:</strong> modeled transparently as about <em>one extra monthly payment per year</em>
      (26 half-payments ‚âà 13 monthly). Always consult a licensed professional.
    </p>
  </section>

  <!-- Refi Break-even -->
  <section class="card" id="break-card">
    <h2>üîÑ Refinance Break-Even</h2>
    <div class="subgrid">
      <div>
        <label for="b_costs">Total refinance costs ($)</label>
        <input id="b_costs" type="number" value="4500" />
      </div>
      <div>
        <label for="b_savings">Monthly payment savings ($)</label>
        <input id="b_savings" type="number" value="150" />
      </div>
      <div style="display:flex; align-items:end">
        <button id="b_go" class="btn">Calculate</button>
      </div>
    </div>

    <div class="kpis" style="margin-top:14px">
      <div class="kpi"><div>Break-even (months)</div><small id="b_months">‚Äî</small></div>
      <div class="kpi"><div>Rounded up</div><small id="b_round">‚Äî</small></div>
    </div>

    <p style="margin-top:10px; font-size:13px; color:#333">
      Formula: <strong>months = total refinance costs √∑ monthly savings</strong>.
      If savings ‚â§ 0, break-even is not achievable.
    </p>
  </section>
</div>

<footer>
  <div class="foot-wrap">
    <div class="foot-grid">
      <div>¬© Sabrina Montalvo ‚Äî Valuable Calculator‚Ñ¢</div>
      <div class="links">
        <a href="terms.html">Terms</a>
        <a href="privacy.html">Privacy</a>
        <a href="accessibility.html">Accessibility</a>
      </div>
    </div>
    <div class="foot-grid" style="margin-top:8px">
      <div>Compliance: NMLS #575897 ¬∑ Subject to program rules</div>
      <div class="note">Best viewed from a laptop or desktop for full experience. Mobile-optimized version coming soon.</div>
    </div>
  </div>
</footer>

<script>
/* ===== Utilities ===== */
const fmtMoney = v => (isFinite(v)? v:0).toLocaleString(undefined,{style:'currency',currency:'USD'});
const clamp = (v,min,max)=>Math.max(min,Math.min(max,v));

/* ===== Calculator (keyboard only when display focused) ===== */
(() => {
  const disp = document.getElementById('calcDisplay');
  const keys = document.querySelectorAll('#calc-card .calc [data-k]');
  const back = document.getElementById('calcBack');

  function put(k){
    if(k==='='){ try{ disp.value = '' + (Function(`"use strict";return (${disp.value||0})`)()); }catch{ /* ignore */ } return; }
    const cur = disp.value === '0' ? '' : disp.value;
    disp.value = cur + k;
  }
  keys.forEach(b => b.addEventListener('click', () => put(b.dataset.k)));
  back.addEventListener('click', ()=> disp.value = disp.value.length>1 ? disp.value.slice(0,-1) : '0');

  // keyboard only when focused
  disp.addEventListener('keydown', (e)=>{
    const k = e.key;
    if(/[0-9.+\-*/()]/.test(k)){ /* allow */ }
    else if(k==='Enter'){ e.preventDefault(); put('='); }
    else if(k==='Backspace'){ /* allow */ }
    else { e.preventDefault(); }
  });
})();

/* ===== Equity + Donut ===== */
(() => {
  const els = {
    v:document.getElementById('eqValue'),
    m:document.getElementById('eqMort'),
    o:document.getElementById('eqOther'),
    b:document.getElementById('eqBench'),
    calc:document.getElementById('eqCalc'),
    debt:document.getElementById('kpiDebt'),
    ltv:document.getElementById('kpiLTV'),
    max:document.getElementById('kpiMax'),
    avail:document.getElementById('kpiAvail'),
    canvas:document.getElementById('donut')
  };

  function compute(){
    const V = +els.v.value||0;
    const M = +els.m.value||0;
    const O = +els.o.value||0;
    const B = clamp(+els.b.value||80, 60, 100) / 100; // 0.8 default
    els.b.value = Math.round(B*100);

    const totalDebt = M + O;
    const ltv = V>0 ? totalDebt / V : 0;

    const maxLoanAtBench = V * B;
    const available = Math.max(0, maxLoanAtBench - totalDebt);
    // Required (untouchable) equity = V - maxLoanAtBench
    const untouchable = Math.max(0, V - maxLoanAtBench);

    els.debt.textContent = fmtMoney(totalDebt);
    els.ltv.textContent = (ltv*100).toFixed(1)+'%';
    els.max.textContent = fmtMoney(maxLoanAtBench);
    els.avail.textContent = fmtMoney(available);

    draw(V,M,O,available,untouchable);
  }

  function draw(V,M,O,Avail,Untouch){
    const cx = els.canvas.getContext('2d');
    const W = els.canvas.width, H = els.canvas.height;
    cx.clearRect(0,0,W,H);

    const center = {x:W/2, y:H/2};
    const R = Math.min(W,H)/2 - 8;
    const inner = R * 0.58;

    // draw base ring outline
    cx.lineWidth = 1;
    cx.strokeStyle = '#d8d3cc';
    cx.beginPath();
    cx.arc(center.x,center.y,R,0,Math.PI*2);
    cx.stroke();

    // start angle at top (12 o‚Äôclock)
    let a = -Math.PI/2;
    const drawSlice = (val, color) => {
      const frac = V>0 ? clamp(val/V,0,1) : 0;
      const sweep = frac * Math.PI*2;
      if(sweep<=0.0001) return;
      cx.beginPath();
      cx.arc(center.x,center.y,R,a,a+sweep);
      cx.arc(center.x,center.y,inner,a+sweep,a,true);
      cx.closePath();
      cx.fillStyle = color;
      cx.fill();
      a += sweep;
    };

    // Order: Mortgage (mauve) -> Other liens (mint) -> Available (gold) -> Untouchable (cream)
    drawSlice(M, getComputedStyle(document.documentElement).getPropertyValue('--mauve').trim() || '#C8A1C6');
    drawSlice(O, getComputedStyle(document.documentElement).getPropertyValue('--mint').trim() || '#7FBF9E');
    drawSlice(Avail, getComputedStyle(document.documentElement).getPropertyValue('--gold').trim() || '#C6AA58');
    drawSlice(Untouch, '#f5f2ea');

    // start tick at 12 o‚Äôclock
    cx.strokeStyle = '#b3ad9f';
    cx.lineWidth = 3;
    cx.beginPath();
    cx.moveTo(center.x, center.y - R);
    cx.lineTo(center.x, center.y - R + 14);
    cx.stroke();
  }

  ['input','change'].forEach(ev=>{
    els.v.addEventListener(ev,()=>{/* noop */});
    els.m.addEventListener(ev,()=>{/* noop */});
    els.o.addEventListener(ev,()=>{/* noop */});
    els.b.addEventListener(ev,()=>{/* noop */});
  });
  els.calc.addEventListener('click', compute);

  // initial
  compute();
})();

/* ===== Amortization ===== */
(() => {
  const $ = id=>document.getElementById(id);
  const amount=$('a_amount'), apr=$('a_apr'), term=$('a_term'), start=$('a_start'),
        curr=$('a_curr'), extra=$('a_extra'), bi=$('a_biweekly'),
        lump=$('a_lump'), lumpm=$('a_lumpm'),
        base=$('a_base'), payoff=$('a_payoff'), saved=$('a_saved'), msaved=$('a_msaved'),
        tbl=$('a_tbl').querySelector('tbody'), go=$('a_go');

  // default start to next month
  const d=new Date(); d.setDate(1); d.setMonth(d.getMonth()+1);
  start.valueAsDate = d;

  function calc(){
    const P0 = +(amount.value||0);
    const R = (+(apr.value||0))/100/12;
    const N = +(term.value||0) * 12;
    const startDate = new Date(start.value||new Date());
    let bal = +(curr.value||P0);
    if (bal<=0) bal=P0;

    // base monthly payment (no extras)
    const Pmt = R===0 ? bal/N : bal*R/(1-Math.pow(1+R,-N));
    base.textContent = fmtMoney(Pmt);

    tbl.innerHTML='';
    let totalIntBase = 0, totalIntNew = 0;
    let month=0, date=new Date(startDate);
    let paidOffDate = null;

    while (bal>0 && month< N+600){
      month++;
      const interest = bal*R;
      totalIntNew += interest;
      let principal = Math.min(Pmt - interest, bal);

      let extraNow = +(extra.value||0);

      // bi-weekly modeled as ~1 extra payment per year (simple & transparent)
      if (bi.value==='Yes' && month%12===0) extraNow += Pmt;

      // add lump sum at chosen month #
      if (+lump.value>0 && +lumpm.value===month) extraNow += +lump.value;

      const totalPrincipal = Math.min(principal + extraNow, bal);
      bal = +(bal - totalPrincipal).toFixed(6);

      // fill row
      const tr=document.createElement('tr');
      const row = [
        month,
        date.toLocaleDateString(undefined,{year:'numeric',month:'short'}),
        fmtMoney(Pmt + extraNow),
        fmtMoney(interest),
        fmtMoney(principal),
        fmtMoney(extraNow),
        fmtMoney(Math.max(bal,0))
      ];
      row.forEach(x=>{ const td=document.createElement('td'); td.textContent=x; tr.appendChild(td); });
      tbl.appendChild(tr);

      if (bal<=0 && !paidOffDate){ paidOffDate = new Date(date); }

      // advance date
      date.setMonth(date.getMonth()+1);
    }

    // baseline interest if no extras (for savings calc)
    // (simple approximate baseline using standard amort formula)
    let bal2 = +(curr.value||P0);
    if (bal2<=0) bal2=P0;
    for(let i=0;i<N;i++){
      const int2 = bal2*R;
      totalIntBase += int2;
      const prin2 = Math.min(Pmt - int2, bal2);
      bal2 -= prin2;
      if (bal2<=0) break;
    }

    saved.textContent = fmtMoney(Math.max(0,totalIntBase-totalIntNew));
    payoff.textContent = paidOffDate ? paidOffDate.toLocaleDateString(undefined,{year:'numeric',month:'long'}) : '‚Äî';

    // months saved (very rough): difference between months actually used vs full term
    const monthsUsed = month;
    msaved.textContent = Math.max(0, (term.value*12) - monthsUsed);
  }
  go.addEventListener('click', calc);
})();

/* ===== Break-even ===== */
(() => {
  const costs=document.getElementById('b_costs'),
        sav=document.getElementById('b_savings'),
        go=document.getElementById('b_go'),
        outM=document.getElementById('b_months'),
        outR=document.getElementById('b_round');

  function run(){
    const c=+(costs.value||0), s=+(sav.value||0);
    if(s<=0){ outM.textContent='‚Äî'; outR.textContent='‚Äî'; return; }
    const m = c/s;
    outM.textContent = m.toFixed(2);
    outR.textContent = Math.ceil(m);
  }
  go.addEventListener('click', run);
})();
</script>
</body>
</html>
